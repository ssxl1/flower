<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.ypf.cn.dao.ClassroomMapper" >
 <resultMap id="BaseResultMap" type="com.ypf.cn.domain.Classroom" >
    <id column="id" property="id" jdbcType="INTEGER" />
    <result column="name" property="name" jdbcType="VARCHAR" />
    <result column="descirption" property="descirption" jdbcType="VARCHAR" />
    <result column="createdate" property="createdate" jdbcType="DATE" />
    <result column="enddate" property="enddate" jdbcType="DATE" />
    <result column="status" property="status" jdbcType="VARCHAR" />
    <result column="type" property="type" jdbcType="VARCHAR" />
    <result column="price" property="price" jdbcType="INTEGER" />
    <result column="num" property="num" jdbcType="INTEGER" />
    <result column="allmoney" property="allmoney" jdbcType="DOUBLE" />
  </resultMap>
  
  <resultMap id="JoinResultMap" type="com.ypf.cn.domain.Classroom" >
    <id column="id" property="id" jdbcType="INTEGER" />
    <result column="name" property="name" jdbcType="VARCHAR" />
    <result column="descirption" property="descirption" jdbcType="VARCHAR" />
    <result column="createdate" property="createdate" jdbcType="DATE" />
     <result column="enddate" property="enddate" jdbcType="DATE" />
    <result column="status" property="status" jdbcType="VARCHAR" />
    <result column="type" property="type" jdbcType="VARCHAR" />
    <result column="price" property="price" jdbcType="INTEGER" />
    <result column="num" property="num" jdbcType="INTEGER" />
    
     <collection property="teacherlist" ofType="com.ypf.cn.domain.Middleteacher">
			<!-- 定义这个集合中元素的封装规则 -->
			<result column="tid" property="tid"/>
			<result column="tuid" property="tuid"/>
			<result column="tname" property="tname"/>
		</collection>
		<collection property="studentlist" ofType="com.ypf.cn.domain.Middlestudent">
			<!-- 定义这个集合中元素的封装规则 -->
			<result column="sid" property="sid"/>
			<result column="uid" property="uid"/>
			<result column="sname" property="sname"/>
		</collection>
  </resultMap>
  
  
   <resultMap id="DetailResultMap" type="com.ypf.cn.domain.Classroom" >
    <id column="id" property="id" jdbcType="INTEGER" />
    <result column="name" property="name" jdbcType="VARCHAR" />
    <result column="descirption" property="descirption" jdbcType="VARCHAR" />
    <result column="createdate" property="createdate" jdbcType="DATE" />
     <result column="enddate" property="enddate" jdbcType="DATE" />
    <result column="status" property="status" jdbcType="VARCHAR" />
    <result column="type" property="type" jdbcType="VARCHAR" />
    <result column="price" property="price" jdbcType="INTEGER" />
    <result column="num" property="num" jdbcType="INTEGER" />
    
     <collection property="teacherlist" ofType="com.ypf.cn.domain.Middleteacher">
			<!-- 定义这个集合中元素的封装规则 -->
			<result column="tid" property="tid"/>
			<result column="tuid" property="tuid"/>
			<result column="tname" property="tname"/>
		</collection>
  </resultMap>
  
  <sql id="Base_Column_List" >
    id, name, descirption, createdate, enddate, status, type, price, num,allmoney
  </sql>
  
  
   <select id="selectByJoin" resultMap="JoinResultMap" parameterType="java.util.HashMap" >
 select   c.id id, c.name name, c.descirption descirption, c.createdate createdate, c.enddate enddate,c.status status, c.type type, c.price price,c.num num,
    s.sname sname, s.sid sid,s.uid uid, t.tname tname, t.tid tid, t.tuid tuid
    from classroom c, middlestudent s,middleteacher t  where  c.id=s.cid and c.id=t.cid 
    
    	<if test="id!=null">
			and c.id = #{id,jdbcType=INTEGER}
	 	</if>
	 	<if test="uid!=null">
			and s.uid = #{uid,jdbcType=INTEGER}
	 	</if>
	 	<if test="name!=null">
			and c.name  LIKE CONCAT('%',#{name},'%') 
	 	</if>
	 	<if test="startPos!=null">
		order by c.id desc  limit #{startPos},#{limit}
	 	</if>
  </select>
  
  
     <select id="selectByJoinDetail" resultMap="DetailResultMap" parameterType="java.util.HashMap" >
 select   c.id id, c.name name, c.descirption descirption, c.createdate createdate, c.enddate enddate,c.status status, c.type type, c.price price,c.num num,
    t.tname tname, t.tid tid, t.tuid tuid
    from classroom c,middleteacher t  where   c.id=t.cid 
    
    	<if test="id!=null">
			and c.id = #{id,jdbcType=INTEGER}
	 	</if>
	 	<if test="uid!=null">
			and s.uid = #{uid,jdbcType=INTEGER}
	 	</if>
	 	<if test="name!=null">
			and c.name  LIKE CONCAT('%',#{name},'%') 
	 	</if>
	 	<if test="startPos!=null">
		order by c.id desc  limit #{startPos},#{limit}
	 	</if>
  </select>
  
  
  
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    select 
    <include refid="Base_Column_List" />
    from classroom
    where id = #{id,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    delete from classroom
    where id = #{id,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.ypf.cn.domain.Classroom" >
    insert into classroom (id, name, descirption, 
      createdate, enddate, status, 
      type, price, num)
    values (#{id,jdbcType=INTEGER}, #{name,jdbcType=VARCHAR}, #{descirption,jdbcType=VARCHAR}, 
      #{createdate,jdbcType=DATE}, #{enddate,jdbcType=DATE}, #{status,jdbcType=VARCHAR}, 
      #{type,jdbcType=VARCHAR}, #{price,jdbcType=INTEGER}, #{num,jdbcType=INTEGER})
  </insert>
  <insert id="insertSelective" parameterType="com.ypf.cn.domain.Classroom" keyProperty="id" useGeneratedKeys="true" >
    insert into classroom
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        id,
      </if>
      <if test="name != null" >
        name,
      </if>
      <if test="descirption != null" >
        descirption,
      </if>
      <if test="createdate != null" >
        createdate,
      </if>
      <if test="enddate != null" >
        enddate,
      </if>
      <if test="status != null" >
        status,
      </if>
      <if test="type != null" >
        type,
      </if>
      <if test="price != null" >
        price,
      </if>
      <if test="num != null" >
        num,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        #{id,jdbcType=INTEGER},
      </if>
      <if test="name != null" >
        #{name,jdbcType=VARCHAR},
      </if>
      <if test="descirption != null" >
        #{descirption,jdbcType=VARCHAR},
      </if>
      <if test="createdate != null" >
        #{createdate,jdbcType=DATE},
      </if>
      <if test="enddate != null" >
        #{enddate,jdbcType=DATE},
      </if>
      <if test="status != null" >
        #{status,jdbcType=VARCHAR},
      </if>
      <if test="type != null" >
        #{type,jdbcType=VARCHAR},
      </if>
      <if test="price != null" >
        #{price,jdbcType=INTEGER},
      </if>
      <if test="num != null" >
        #{num,jdbcType=INTEGER},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.ypf.cn.domain.Classroom" >
    update classroom
    <set >
      <if test="name != null" >
        name = #{name,jdbcType=VARCHAR},
      </if>
      <if test="descirption != null" >
        descirption = #{descirption,jdbcType=VARCHAR},
      </if>
      <if test="createdate != null" >
        createdate = #{createdate,jdbcType=DATE},
      </if>
      <if test="enddate != null" >
        enddate = #{enddate,jdbcType=DATE},
      </if>
      <if test="status != null" >
        status = #{status,jdbcType=VARCHAR},
      </if>
      <if test="type != null" >
        type = #{type,jdbcType=VARCHAR},
      </if>
      <if test="price != null" >
        price = #{price,jdbcType=INTEGER},
      </if>
      <if test="num != null" >
        num = #{num,jdbcType=INTEGER},
      </if>
      <if test="allmoney != null" >
        allmoney = #{allmoney,jdbcType=DOUBLE},
      </if>  
    </set>
    where id = #{id,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.ypf.cn.domain.Classroom" >
    update classroom
    set name = #{name,jdbcType=VARCHAR},
      descirption = #{descirption,jdbcType=VARCHAR},
      createdate = #{createdate,jdbcType=DATE},
      enddate = #{enddate,jdbcType=DATE},
      status = #{status,jdbcType=VARCHAR},
      type = #{type,jdbcType=VARCHAR},
      price = #{price,jdbcType=INTEGER},
      num = #{num,jdbcType=INTEGER}
    where id = #{id,jdbcType=INTEGER}
  </update> 
  
 
 
 
  <select id="selectByMap"  resultMap="BaseResultMap" parameterType="java.util.HashMap">
        select <include refid="Base_Column_List"/> from classroom where 1=1 
      <if test="id!=null">
			and id = #{id,jdbcType=INTEGER}
	 	</if>
	 	<if test="name!=null">
			and name  LIKE CONCAT('%',#{name},'%') 
	 	</if>
	 	<if test="status!=null">
			and  status = #{status,jdbcType=VARCHAR}
	 	</if>
        <if test="username!=null">
			and username like #{username,jdbcType=VARCHAR}
	 	</if>
	 	<if test="type!=null">
			and type LIKE CONCAT('%',#{type},'%') 
	 	</if>
	 	<if test="startPos!=null">
			limit #{startPos},#{limit}
	 	</if>
	 	
	 	<!-- startPos=(page-1)*limit从第几条数据开始查询  pagesize每页显示几条 -->
    </select>
     
    <select id="findcountbycondition"  resultType="Integer" parameterType="java.util.HashMap">
        select count(*) from classroom where 1=1 
       <if test="id!=null">
			and id = #{id,jdbcType=INTEGER}
	 	</if>
	 	<if test="status!=null">
			and  status = #{status,jdbcType=VARCHAR}
	 	</if>
	 	<if test="name!=null">
			and name  LIKE CONCAT('%',#{name},'%') 
	 	</if>
        <if test="username!=null">
			and username like #{username,jdbcType=VARCHAR}
	 	</if>
	 	<if test="type!=null">
			and type  LIKE CONCAT('%',#{type},'%') 
	 	</if>
    </select>
</mapper>